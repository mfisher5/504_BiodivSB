---
title: "Explore Variables"
author: "Mary Fisher"
date: "March 4, 2020"
output: 
  html_document:
    toc: yes
    toc_float: yes
---

Check out the distributions of all response and predictor variables, and any multicollinearity of predictor variables.



```{r setup, include=FALSE}
rm(list=ls())

knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(janitor)
library(here)
library(vegan)
library(lubridate)
library(corrplot)
library(MASS)

theme_set(theme_bw())
```
<br>

Read in data
```{r}
mydat1 <- read.csv(here::here("data","kelp_prediction_data_complete.csv")) %>%
  clean_names()
colnames(mydat1)

mydat2 <- read.csv(here::here("data","biomass_prediction_data_waterchem_bysite_complete.csv")) %>%
  clean_names()
colnames(mydat2)
```
<br>


# Question 1: Kelp Growth & Size

## Distributions

### Response
```{r}
plotdat <- mydat1 %>%
  pivot_longer(cols=colnames(mydat1)[c(4:7)], names_to="variable")
ggplot(data=plotdat, aes(x=value)) + 
  geom_histogram() + 
  facet_wrap(~variable,ncol=2,scales="free")
```
<br>

Log of Response
```{r}
ggplot(data=plotdat, aes(x=log(value))) + 
  geom_density() + 
  facet_wrap(~variable,ncol=2,scales="free")
```
<br>


### Predictor: Herbivory
```{r}
plotdat <- mydat1 %>%
  pivot_longer(cols=colnames(mydat1)[c(10:12)], names_to="variable")
ggplot(data=plotdat, aes(x=value)) + 
  geom_histogram() + 
  facet_wrap(~variable,ncol=2,scales="free")
```
<br>

Log of Variable
```{r}
ggplot(data=plotdat, aes(x=log(value))) + 
  geom_density() + 
  facet_wrap(~variable,ncol=2,scales="free")
```


### Predictor: Water Chemistry

Max Values
```{r}
plotdat <- mydat1 %>%
  pivot_longer(cols=colnames(mydat1)[c(13:18)], names_to="variable")
ggplot(data=plotdat, aes(x=value)) + 
  geom_histogram() + 
  facet_wrap(~variable,ncol=2,scales="free")
```
<br>

Log /sqrt of max variables
```{r}
plotdat <- mydat1 %>%
  pivot_longer(cols=c(max_pon,max_poc,max_tchl), names_to="variable")
ggplot(data=plotdat, aes(x=log(value))) + 
  geom_density() + 
  facet_wrap(~variable,ncol=2,scales="free")
plotdat <- mydat1 %>%
  pivot_longer(cols=c(max_ammonia,max_no2_no3,max_po4), names_to="variable")
ggplot(data=plotdat, aes(x=value^2)) + 
  geom_density() + 
  facet_wrap(~variable,ncol=2,scales="free")
```
<br>

Mean values
```{r}
plotdat <- mydat1 %>%
  pivot_longer(cols=colnames(mydat1)[c(19:24)], names_to="variable")
ggplot(data=plotdat, aes(x=value)) + 
  geom_histogram() + 
  facet_wrap(~variable,ncol=2,scales="free")
```
<br>

Log of mean variables
```{r}
plotdat <- mydat1 %>%
  pivot_longer(cols=c(mean_pon,mean_poc,mean_tchl), names_to="variable")
ggplot(data=plotdat, aes(x=log(value))) + 
  geom_density() + 
  facet_wrap(~variable,ncol=2,scales="free")
```



### Predictor: Water Temperature

```{r}
plotdat <- mydat1 %>%
  pivot_longer(cols=colnames(mydat1)[c(25:28)], names_to="variable")
ggplot(data=plotdat, aes(x=value)) + 
  geom_histogram() + 
  facet_wrap(~variable,ncol=2,scales="free")
```

## Multicollinearity

### Max values

```{r}
corrplot(cor(mydat1[,c(10:18,25:28)],use="complete.obs"), type="upper")
```
<br>

### Mean values
```{r}
corrplot(cor(mydat1[,c(10:12,19:28)], use="complete.obs"), type="upper")
```
<br>


# Question 2: Biodiversity

## Distributions

### Response
```{r}
plotdat <- dplyr::select(mydat2, -year, -month) %>%
  pivot_longer(cols=colnames(mydat2)[c(4:9)], names_to="variable")
ggplot(data=plotdat, aes(x=value)) + 
  geom_histogram() + 
  facet_wrap(~variable,ncol=3,scales="free")
```
<br>

Log of Response
```{r}
ggplot(data=plotdat, aes(x=log(value))) + 
  geom_density() + 
  facet_wrap(~variable,ncol=3,scales="free")
```

### Predictor: Water Temperature
```{r}
plotdat <- dplyr::select(mydat2, -year, -month) %>%
  pivot_longer(cols=colnames(mydat2)[c(11:14)], names_to="variable")
ggplot(data=plotdat, aes(x=value)) + 
  geom_histogram() + 
  facet_wrap(~variable,ncol=2,scales="free")
```

### Predictor: Water Chemistry
```{r}
plotdat <- dplyr::select(mydat2, -year, -month) %>%
  pivot_longer(cols=colnames(mydat2)[c(15:20)], names_to="variable")
ggplot(data=plotdat, aes(x=value)) + 
  geom_histogram() + 
  facet_wrap(~variable,ncol=2,scales="free")
```
```{r}
plotdat <- dplyr::select(mydat2, -year, -month) %>%
  pivot_longer(cols=colnames(mydat2)[c(21:26)], names_to="variable")
ggplot(data=plotdat, aes(x=value)) + 
  geom_histogram() + 
  facet_wrap(~variable,ncol=2,scales="free")
```
<br>

### Predictor: Kelp

```{r}
plotdat <- dplyr::select(mydat2, -year, -month) %>%
  pivot_longer(cols=colnames(mydat2)[10], names_to="variable")
ggplot(data=plotdat, aes(x=value)) + 
  geom_histogram() + 
  facet_wrap(~variable,ncol=2,scales="free")
```
<br>

Cubed root of variable
```{r}
ggplot(data=plotdat, aes(x=value^(1/3))) + 
  geom_density() + 
  facet_wrap(~variable,ncol=2,scales="free")
```

## Multicollinearity

### Max values

```{r}
corrplot(cor(mydat2[,c(10:20)],use="complete.obs"), type="upper")
```
<br>

### Mean values
```{r}
corrplot(cor(mydat2[,c(10:14,21:26)],use="complete.obs"), type="upper")
```












